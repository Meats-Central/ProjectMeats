{
  "name": "ProjectMeats Dev Codespace",
  "dockerComposeFile": "docker-compose.yml",
  "service": "app",
  "workspaceFolder": "/workspaces/ProjectMeats",
  "remoteUser": "root",

  // Forward ports for Backend (8000), Frontend (3000), and DB (5432)
  "forwardPorts": [8000, 3000, 5432],

  "remoteEnv": {
    "DJANGO_SETTINGS_MODULE": "${localEnv:DEV_DJANGO_SETTINGS_MODULE}",
    "SECRET_KEY": "${localEnv:DEV_SECRET_KEY}",
    "DATABASE_URL": "postgres://postgres:postgres@db:5432/projectmeats_dev",
    "DB_ENGINE": "${localEnv:DEV_DB_ENGINE}",
    "DB_NAME": "projectmeats_dev",
    "DB_USER": "postgres",
    "DB_PASSWORD": "postgres",
    "DB_HOST": "db",
    "DB_PORT": "5432",
    "ALLOWED_HOSTS": "${localEnv:DEV_ALLOWED_HOSTS}",
    "CORS_ALLOWED_ORIGINS": "${localEnv:DEV_CORS_ALLOWED_ORIGINS}",
    "LOG_LEVEL": "${localEnv:LOG_LEVEL}"
  },

  "settings": {
    "terminal.integrated.shell.linux": "/bin/bash",
    "editor.formatOnSave": true,
    "python.defaultInterpreterPath": "/venv/bin/python",
    // Ensure Copilot is enabled for all languages
    "github.copilot.enable": {
      "*": true
    }
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "GitHub.copilot",           // Code completion (Ghost text)
        "GitHub.copilot-chat",      // REQUIRED: Terminal Agent & Chat Pane
        "ms-azuretools.vscode-docker",
        "ms-python.python",
        "dbaeumer.vscode-eslint"
      ]
    }
  },

  "features": {
    // Ensures 'gh' CLI is installed for legacy CLI agent if needed
    "ghcr.io/devcontainers/features/github-cli:1": {}
  },

  // CRITICAL: Runs your idempotent multi-tenant migrations
  "postCreateCommand": "bash .devcontainer/setup.sh"
}

