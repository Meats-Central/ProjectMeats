{
  "project": "ProjectMeats",
  "version": "5.0",
  "description": "Environment-Scoped Secrets (NO prefixes) - Aligned with Working Pipeline",
  "last_updated": "2025-12-31",
  "architecture": "GitHub Environment Secrets with identical names across all environments",
  "environments": {
    "dev-backend": {
      "type": "backend",
      "django_settings": "projectmeats.settings.development",
      "github_environment": "dev-backend",
      "deployment_target": "development"
    },
    "dev-frontend": {
      "type": "frontend",
      "url": "https://dev.meatscentral.com",
      "github_environment": "dev-frontend",
      "deployment_target": "development"
    },
    "uat-backend": {
      "type": "backend",
      "django_settings": "projectmeats.settings.staging",
      "github_environment": "uat-backend",
      "deployment_target": "uat"
    },
    "uat-frontend": {
      "type": "frontend",
      "url": "https://uat.meatscentral.com",
      "github_environment": "uat-frontend",
      "deployment_target": "uat"
    },
    "production-backend": {
      "type": "backend",
      "django_settings": "projectmeats.settings.production",
      "github_environment": "production-backend",
      "deployment_target": "production"
    },
    "production-frontend": {
      "type": "frontend",
      "url": "https://meatscentral.com",
      "github_environment": "production-frontend",
      "deployment_target": "production"
    }
  },
  "repository_secrets": {
    "DO_ACCESS_TOKEN": {
      "description": "DigitalOcean Container Registry access token",
      "scope": "repository",
      "required": true,
      "used_by": ["all workflows"]
    },
    "PAT": {
      "description": "Personal Access Token for GitHub API operations",
      "scope": "repository",
      "required": true,
      "used_by": ["ops-release-automation.yml"]
    }
  },
  "environment_secrets": {
    "infrastructure": {
      "SSH_HOST": {
        "description": "Droplet IP address",
        "scope": "environment",
        "required": true,
        "note": "Different value per environment, same name"
      },
      "SSH_USER": {
        "description": "SSH username",
        "scope": "environment",
        "required": true,
        "note": "Different value per environment, same name"
      },
      "SSH_PASSWORD": {
        "description": "SSH password (primary auth method)",
        "scope": "environment",
        "required": true,
        "note": "Used by all deployments"
      },
      "SSH_KEY": {
        "description": "SSH private key (legacy/alternative)",
        "scope": "environment",
        "required": false,
        "note": "NOT currently used, kept for compatibility"
      },
      "BACKEND_HOST": {
        "description": "Backend server IP/hostname for nginx routing",
        "scope": "environment",
        "required": true,
        "applies_to": ["frontend environments"],
        "note": "Used by frontend to proxy API requests"
      }
    },
    "backend_application": {
      "DB_HOST": {
        "description": "Private database host",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"]
      },
      "DB_PORT": {
        "description": "Database port",
        "scope": "environment",
        "required": false,
        "default": "5432",
        "applies_to": ["backend environments"]
      },
      "DB_USER": {
        "description": "Database username",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"]
      },
      "DB_PASSWORD": {
        "description": "Database password",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"]
      },
      "DB_NAME": {
        "description": "Database name",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"]
      },
      "DJANGO_SECRET_KEY": {
        "description": "Django secret key for cryptographic signing",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"]
      },
      "DJANGO_SETTINGS_MODULE": {
        "description": "Django settings module path",
        "scope": "environment",
        "required": true,
        "applies_to": ["backend environments"],
        "values": {
          "dev-backend": "projectmeats.settings.development",
          "uat-backend": "projectmeats.settings.staging",
          "production-backend": "projectmeats.settings.production"
        }
      },
      "DJANGO_SUPERUSER_USERNAME": {
        "description": "Django superuser username",
        "scope": "environment",
        "required": false,
        "applies_to": ["backend environments"]
      },
      "DJANGO_SUPERUSER_EMAIL": {
        "description": "Django superuser email",
        "scope": "environment",
        "required": false,
        "applies_to": ["backend environments"]
      },
      "DJANGO_SUPERUSER_PASSWORD": {
        "description": "Django superuser password",
        "scope": "environment",
        "required": false,
        "applies_to": ["backend environments"]
      }
    },
    "frontend_runtime": {
      "REACT_APP_API_BASE_URL": {
        "description": "API base URL for frontend runtime config",
        "scope": "environment",
        "required": true,
        "applies_to": ["frontend environments"],
        "values": {
          "dev-frontend": "https://dev.meatscentral.com",
          "uat-frontend": "https://uat.meatscentral.com",
          "production-frontend": "https://meatscentral.com"
        }
      },
      "REACT_APP_ENVIRONMENT": {
        "description": "Environment identifier for frontend",
        "scope": "environment",
        "required": false,
        "applies_to": ["frontend environments"]
      },
      "REACT_APP_AI_ASSISTANT_ENABLED": {
        "description": "Feature flag for AI assistant",
        "scope": "environment",
        "required": false,
        "applies_to": ["frontend environments"]
      }
    }
  },
  "validation": {
    "audit_command": "python config/manage_env.py audit",
    "required_repository_secrets": ["DO_ACCESS_TOKEN", "PAT"],
    "required_backend_secrets": [
      "SSH_HOST", "SSH_USER", "SSH_PASSWORD",
      "DB_HOST", "DB_USER", "DB_PASSWORD", "DB_NAME",
      "DJANGO_SECRET_KEY", "DJANGO_SETTINGS_MODULE"
    ],
    "required_frontend_secrets": [
      "SSH_HOST", "SSH_USER", "SSH_PASSWORD",
      "BACKEND_HOST", "REACT_APP_API_BASE_URL"
    ],
    "optional_secrets": [
      "SSH_KEY", "DB_PORT",
      "DJANGO_SUPERUSER_USERNAME", "DJANGO_SUPERUSER_EMAIL", "DJANGO_SUPERUSER_PASSWORD",
      "REACT_APP_ENVIRONMENT", "REACT_APP_AI_ASSISTANT_ENABLED"
    ]
  },
  "notes": {
    "architecture_change": "Version 5.0 reflects the ACTUAL working pipeline. All secrets use identical names across environments and are scoped to GitHub Environments (not prefixed).",
    "secret_isolation": "Secrets are isolated by GitHub Environment scope (dev-backend, dev-frontend, uat-backend, etc.), NOT by name prefixes.",
    "deployment_workflow": "See .github/workflows/main-pipeline.yml and .github/workflows/reusable-deploy.yml for actual secret usage.",
    "audit_script_status": "The manage_env.py audit script needs updating to match v5.0 architecture."
  }
}
